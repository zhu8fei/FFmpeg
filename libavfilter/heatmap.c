/* heatmap - High performance heatmap creation in C.
 *
 * The MIT License (MIT)
 *
 * Copyright (c) 2013 Lucas Beyer
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

#include "heatmap.h"

#include <stdlib.h> /* malloc, calloc, free */
#include <string.h> /* memcpy, memset */
#include <math.h>   /* sqrtf */
#include <assert.h> /* assert, #define NDEBUG to ignore. */

/* Having a default stamp ready makes it easier for simple usage of the library
 * since there is no need to create a new stamp.
 */
static float stamp_default_4_data[] = {
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000459f, 0.007373f, 0.013405f, 0.018537f, 0.022757f, 0.026051f,
        0.028411f, 0.029830f, 0.030303f, 0.029830f, 0.028411f, 0.026051f, 0.022757f, 0.018537f, 0.013405f, 0.007373f,
        0.000459f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.003219f, 0.012940f, 0.021817f, 0.029830f,
        0.036955f, 0.043173f, 0.048466f, 0.052818f, 0.056217f, 0.058653f, 0.060117f, 0.060606f, 0.060117f, 0.058653f,
        0.056217f, 0.052818f, 0.048466f, 0.043173f, 0.036955f, 0.029830f, 0.021817f, 0.012940f, 0.003219f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.009225f,
        0.020879f, 0.031725f, 0.041734f, 0.050881f, 0.059141f, 0.066490f, 0.072906f, 0.078369f, 0.082864f, 0.086375f,
        0.088891f, 0.090404f, 0.090909f, 0.090404f, 0.088891f, 0.086375f, 0.082864f, 0.078369f, 0.072906f, 0.066490f,
        0.059141f, 0.050881f, 0.041734f, 0.031725f, 0.020879f, 0.009225f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.010617f, 0.024167f, 0.036955f, 0.048948f, 0.060117f, 0.070433f, 0.079865f, 0.088387f,
        0.095974f, 0.102600f, 0.108246f, 0.112892f, 0.116522f, 0.119125f, 0.120690f, 0.121212f, 0.120690f, 0.119125f,
        0.116522f, 0.112892f, 0.108246f, 0.102600f, 0.095974f, 0.088387f, 0.079865f, 0.070433f, 0.060117f, 0.048948f,
        0.036955f, 0.024167f, 0.010617f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.007373f, 0.022757f, 0.037431f, 0.051365f, 0.064524f,
        0.076876f, 0.088387f, 0.099026f, 0.108761f, 0.117562f, 0.125402f, 0.132253f, 0.138093f, 0.142901f, 0.146659f,
        0.149353f, 0.150974f, 0.151515f, 0.150974f, 0.149353f, 0.146659f, 0.142901f, 0.138093f, 0.132253f, 0.125402f,
        0.117562f, 0.108761f, 0.099026f, 0.088387f, 0.076876f, 0.064524f, 0.051365f, 0.037431f, 0.022757f, 0.007373f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.016668f,
        0.033148f, 0.048948f, 0.064034f, 0.078369f, 0.091920f, 0.104649f, 0.116522f, 0.127504f, 0.137561f, 0.146659f,
        0.154768f, 0.161860f, 0.167907f, 0.172888f, 0.176783f, 0.179577f, 0.181257f, 0.181818f, 0.181257f, 0.179577f,
        0.176783f, 0.172888f, 0.167907f, 0.161860f, 0.154768f, 0.146659f, 0.137561f, 0.127504f, 0.116522f, 0.104649f,
        0.091920f, 0.078369f, 0.064034f, 0.048948f, 0.033148f, 0.016668f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.005987f, 0.024167f, 0.041734f, 0.058653f, 0.074889f, 0.090404f, 0.105162f, 0.119125f,
        0.132253f, 0.144509f, 0.155855f, 0.166254f, 0.175668f, 0.184066f, 0.191414f, 0.197685f, 0.202852f, 0.206894f,
        0.209794f, 0.211539f, 0.212121f, 0.211539f, 0.209794f, 0.206894f, 0.202852f, 0.197685f, 0.191414f, 0.184066f,
        0.175668f, 0.166254f, 0.155855f, 0.144509f, 0.132253f, 0.119125f, 0.105162f, 0.090404f, 0.074889f, 0.058653f,
        0.041734f, 0.024167f, 0.005987f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.010617f, 0.029830f, 0.048466f, 0.066490f,
        0.083866f, 0.100556f, 0.116522f, 0.131724f, 0.146121f, 0.159671f, 0.172333f, 0.184066f, 0.194829f, 0.204581f,
        0.213288f, 0.220912f, 0.227421f, 0.232789f, 0.236989f, 0.240004f, 0.241818f, 0.242424f, 0.241818f, 0.240004f,
        0.236989f, 0.232789f, 0.227421f, 0.220912f, 0.213288f, 0.204581f, 0.194829f, 0.184066f, 0.172333f, 0.159671f,
        0.146121f, 0.131724f, 0.116522f, 0.100556f, 0.083866f, 0.066490f, 0.048466f, 0.029830f, 0.010617f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.013405f, 0.033623f, 0.053303f, 0.072410f, 0.090909f, 0.108761f, 0.125927f, 0.142365f, 0.158034f, 0.172888f,
        0.186884f, 0.199977f, 0.212121f, 0.223272f, 0.233387f, 0.242424f, 0.250344f, 0.257112f, 0.262695f, 0.267067f,
        0.270206f, 0.272096f, 0.272727f, 0.272096f, 0.270206f, 0.267067f, 0.262695f, 0.257112f, 0.250344f, 0.242424f,
        0.233387f, 0.223272f, 0.212121f, 0.199977f, 0.186884f, 0.172888f, 0.158034f, 0.142365f, 0.125927f, 0.108761f,
        0.090909f, 0.072410f, 0.053303f, 0.033623f, 0.013405f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.014336f, 0.035525f, 0.056217f, 0.076379f, 0.095974f, 0.114965f,
        0.133312f, 0.150974f, 0.167907f, 0.184066f, 0.199403f, 0.213871f, 0.227421f, 0.240004f, 0.251570f, 0.262073f,
        0.271466f, 0.279705f, 0.286751f, 0.292569f, 0.297126f, 0.300400f, 0.302372f, 0.303030f, 0.302372f, 0.300400f,
        0.297126f, 0.292569f, 0.286751f, 0.279705f, 0.271466f, 0.262073f, 0.251570f, 0.240004f, 0.227421f, 0.213871f,
        0.199403f, 0.184066f, 0.167907f, 0.150974f, 0.133312f, 0.114965f, 0.095974f, 0.076379f, 0.056217f, 0.035525f,
        0.014336f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.013405f, 0.035525f,
        0.057191f, 0.078369f, 0.099026f, 0.119125f, 0.138626f, 0.157489f, 0.175668f, 0.193120f, 0.209794f, 0.225640f,
        0.240608f, 0.254644f, 0.267694f, 0.279705f, 0.290624f, 0.300400f, 0.308985f, 0.316333f, 0.322404f, 0.327164f,
        0.330584f, 0.332645f, 0.333333f, 0.332645f, 0.330584f, 0.327164f, 0.322404f, 0.316333f, 0.308985f, 0.300400f,
        0.290624f, 0.279705f, 0.267694f, 0.254644f, 0.240608f, 0.225640f, 0.209794f, 0.193120f, 0.175668f, 0.157489f,
        0.138626f, 0.119125f, 0.099026f, 0.078369f, 0.057191f, 0.035525f, 0.013405f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.010617f, 0.033623f, 0.056217f, 0.078369f, 0.100046f, 0.121212f, 0.141830f, 0.161860f,
        0.181257f, 0.199977f, 0.217970f, 0.235186f, 0.251570f, 0.267067f, 0.281620f, 0.295169f, 0.307657f, 0.319024f,
        0.329214f, 0.338172f, 0.345847f, 0.352195f, 0.357176f, 0.360757f, 0.362915f, 0.363636f, 0.362915f, 0.360757f,
        0.357176f, 0.352195f, 0.345847f, 0.338172f, 0.329214f, 0.319024f, 0.307657f, 0.295169f, 0.281620f, 0.267067f,
        0.251570f, 0.235186f, 0.217970f, 0.199977f, 0.181257f, 0.161860f, 0.141830f, 0.121212f, 0.100046f, 0.078369f,
        0.056217f, 0.033623f, 0.010617f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.005987f, 0.029830f, 0.053303f, 0.076379f,
        0.099026f, 0.121212f, 0.142901f, 0.164054f, 0.184629f, 0.204581f, 0.223864f, 0.242424f, 0.260209f, 0.277160f,
        0.293218f, 0.308320f, 0.322404f, 0.335403f, 0.347253f, 0.357890f, 0.367254f, 0.375287f, 0.381937f, 0.387159f,
        0.390917f, 0.393182f, 0.393939f, 0.393182f, 0.390917f, 0.387159f, 0.381937f, 0.375287f, 0.367254f, 0.357890f,
        0.347253f, 0.335403f, 0.322404f, 0.308320f, 0.293218f, 0.277160f, 0.260209f, 0.242424f, 0.223864f, 0.204581f,
        0.184629f, 0.164054f, 0.142901f, 0.121212f, 0.099026f, 0.076379f, 0.053303f, 0.029830f, 0.005987f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.024167f, 0.048466f, 0.072410f, 0.095974f, 0.119125f, 0.141830f, 0.164054f, 0.185756f, 0.206894f,
        0.227421f, 0.247288f, 0.266441f, 0.284823f, 0.302372f, 0.319024f, 0.334712f, 0.349366f, 0.362915f, 0.375287f,
        0.386410f, 0.396216f, 0.404640f, 0.411622f, 0.417110f, 0.421061f, 0.423446f, 0.424242f, 0.423446f, 0.421061f,
        0.417110f, 0.411622f, 0.404640f, 0.396216f, 0.386410f, 0.375287f, 0.362915f, 0.349366f, 0.334712f, 0.319024f,
        0.302372f, 0.284823f, 0.266441f, 0.247288f, 0.227421f, 0.206894f, 0.185756f, 0.164054f, 0.141830f, 0.119125f,
        0.095974f, 0.072410f, 0.048466f, 0.024167f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.016668f, 0.041734f, 0.066490f, 0.090909f, 0.114965f,
        0.138626f, 0.161860f, 0.184629f, 0.206894f, 0.228611f, 0.249732f, 0.270206f, 0.289977f, 0.308985f, 0.327164f,
        0.344445f, 0.360757f, 0.376022f, 0.390163f, 0.403100f, 0.414751f, 0.425040f, 0.433893f, 0.441240f, 0.447022f,
        0.451189f, 0.453704f, 0.454545f, 0.453704f, 0.451189f, 0.447022f, 0.441240f, 0.433893f, 0.425040f, 0.414751f,
        0.403100f, 0.390163f, 0.376022f, 0.360757f, 0.344445f, 0.327164f, 0.308985f, 0.289977f, 0.270206f, 0.249732f,
        0.228611f, 0.206894f, 0.184629f, 0.161860f, 0.138626f, 0.114965f, 0.090909f, 0.066490f, 0.041734f, 0.016668f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.007373f,
        0.033148f, 0.058653f, 0.083866f, 0.108761f, 0.133312f, 0.157489f, 0.181257f, 0.204581f, 0.227421f, 0.249732f,
        0.271466f, 0.292569f, 0.312983f, 0.332645f, 0.351487f, 0.369435f, 0.386410f, 0.402331f, 0.417110f, 0.430658f,
        0.442886f, 0.453704f, 0.463029f, 0.470780f, 0.476889f, 0.481296f, 0.483958f, 0.484848f, 0.483958f, 0.481296f,
        0.476889f, 0.470780f, 0.463029f, 0.453704f, 0.442886f, 0.430658f, 0.417110f, 0.402331f, 0.386410f, 0.369435f,
        0.351487f, 0.332645f, 0.312983f, 0.292569f, 0.271466f, 0.249732f, 0.227421f, 0.204581f, 0.181257f, 0.157489f,
        0.133312f, 0.108761f, 0.083866f, 0.058653f, 0.033148f, 0.007373f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.022757f, 0.048948f, 0.074889f, 0.100556f, 0.125927f, 0.150974f,
        0.175668f, 0.199977f, 0.223864f, 0.247288f, 0.270206f, 0.292569f, 0.314321f, 0.335403f, 0.355749f, 0.375287f,
        0.393939f, 0.411622f, 0.428244f, 0.443710f, 0.457923f, 0.470780f, 0.482182f, 0.492029f, 0.500230f, 0.506702f,
        0.511378f, 0.514205f, 0.515152f, 0.514205f, 0.511378f, 0.506702f, 0.500230f, 0.492029f, 0.482182f, 0.470780f,
        0.457923f, 0.443710f, 0.428244f, 0.411622f, 0.393939f, 0.375287f, 0.355749f, 0.335403f, 0.314321f, 0.292569f,
        0.270206f, 0.247288f, 0.223864f, 0.199977f, 0.175668f, 0.150974f, 0.125927f, 0.100556f, 0.074889f, 0.048948f,
        0.022757f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.010617f, 0.037431f,
        0.064034f, 0.090404f, 0.116522f, 0.142365f, 0.167907f, 0.193120f, 0.217970f, 0.242424f, 0.266441f, 0.289977f,
        0.312983f, 0.335403f, 0.357176f, 0.378234f, 0.398502f, 0.417898f, 0.436331f, 0.453704f, 0.469913f, 0.484848f,
        0.498396f, 0.510440f, 0.520867f, 0.529570f, 0.536453f, 0.541432f, 0.544446f, 0.545455f, 0.544446f, 0.541432f,
        0.536453f, 0.529570f, 0.520867f, 0.510440f, 0.498396f, 0.484848f, 0.469913f, 0.453704f, 0.436331f, 0.417898f,
        0.398502f, 0.378234f, 0.357176f, 0.335403f, 0.312983f, 0.289977f, 0.266441f, 0.242424f, 0.217970f, 0.193120f,
        0.167907f, 0.142365f, 0.116522f, 0.090404f, 0.064034f, 0.037431f, 0.010617f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.024167f, 0.051365f, 0.078369f, 0.105162f, 0.131724f, 0.158034f, 0.184066f,
        0.209794f, 0.235186f, 0.260209f, 0.284823f, 0.308985f, 0.332645f, 0.355749f, 0.378234f, 0.400031f, 0.421061f,
        0.441240f, 0.460470f, 0.478647f, 0.495657f, 0.511378f, 0.525683f, 0.538438f, 0.549513f, 0.558781f, 0.566127f,
        0.571450f, 0.574677f, 0.575758f, 0.574677f, 0.571450f, 0.566127f, 0.558781f, 0.549513f, 0.538438f, 0.525683f,
        0.511378f, 0.495657f, 0.478647f, 0.460470f, 0.441240f, 0.421061f, 0.400031f, 0.378234f, 0.355749f, 0.332645f,
        0.308985f, 0.284823f, 0.260209f, 0.235186f, 0.209794f, 0.184066f, 0.158034f, 0.131724f, 0.105162f, 0.078369f,
        0.051365f, 0.024167f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.009225f, 0.036955f, 0.064524f,
        0.091920f, 0.119125f, 0.146121f, 0.172888f, 0.199403f, 0.225640f, 0.251570f, 0.277160f, 0.302372f, 0.327164f,
        0.351487f, 0.375287f, 0.398502f, 0.421061f, 0.442886f, 0.463885f, 0.483958f, 0.502993f, 0.520867f, 0.537444f,
        0.552581f, 0.566127f, 0.577928f, 0.587834f, 0.595707f, 0.601426f, 0.604897f, 0.606061f, 0.604897f, 0.601426f,
        0.595707f, 0.587834f, 0.577928f, 0.566127f, 0.552581f, 0.537444f, 0.520867f, 0.502993f, 0.483958f, 0.463885f,
        0.442886f, 0.421061f, 0.398502f, 0.375287f, 0.351487f, 0.327164f, 0.302372f, 0.277160f, 0.251570f, 0.225640f,
        0.199403f, 0.172888f, 0.146121f, 0.119125f, 0.091920f, 0.064524f, 0.036955f, 0.009225f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.020879f, 0.048948f, 0.076876f, 0.104649f, 0.132253f, 0.159671f, 0.186884f, 0.213871f,
        0.240608f, 0.267067f, 0.293218f, 0.319024f, 0.344445f, 0.369435f, 0.393939f, 0.417898f, 0.441240f, 0.463885f,
        0.485741f, 0.506702f, 0.526652f, 0.545455f, 0.562963f, 0.579017f, 0.593442f, 0.606061f, 0.616694f, 0.625172f,
        0.631348f, 0.635103f, 0.636364f, 0.635103f, 0.631348f, 0.625172f, 0.616694f, 0.606061f, 0.593442f, 0.579017f,
        0.562963f, 0.545455f, 0.526652f, 0.506702f, 0.485741f, 0.463885f, 0.441240f, 0.417898f, 0.393939f, 0.369435f,
        0.344445f, 0.319024f, 0.293218f, 0.267067f, 0.240608f, 0.213871f, 0.186884f, 0.159671f, 0.132253f, 0.104649f,
        0.076876f, 0.048948f, 0.020879f, 0.000000f, 0.000000f, 0.000000f, 0.003219f, 0.031725f, 0.060117f, 0.088387f,
        0.116522f, 0.144509f, 0.172333f, 0.199977f, 0.227421f, 0.254644f, 0.281620f, 0.308320f, 0.334712f, 0.360757f,
        0.386410f, 0.411622f, 0.436331f, 0.460470f, 0.483958f, 0.506702f, 0.528595f, 0.549513f, 0.569313f, 0.587834f,
        0.604897f, 0.620304f, 0.633847f, 0.645312f, 0.654492f, 0.661202f, 0.665292f, 0.666667f, 0.665292f, 0.661202f,
        0.654492f, 0.645312f, 0.633847f, 0.620304f, 0.604897f, 0.587834f, 0.569313f, 0.549513f, 0.528595f, 0.506702f,
        0.483958f, 0.460470f, 0.436331f, 0.411622f, 0.386410f, 0.360757f, 0.334712f, 0.308320f, 0.281620f, 0.254644f,
        0.227421f, 0.199977f, 0.172333f, 0.144509f, 0.116522f, 0.088387f, 0.060117f, 0.031725f, 0.003219f, 0.000000f,
        0.000000f, 0.012940f, 0.041734f, 0.070433f, 0.099026f, 0.127504f, 0.155855f, 0.184066f, 0.212121f, 0.240004f,
        0.267694f, 0.295169f, 0.322404f, 0.349366f, 0.376022f, 0.402331f, 0.428244f, 0.453704f, 0.478647f, 0.502993f,
        0.526652f, 0.549513f, 0.571450f, 0.592314f, 0.611932f, 0.630104f, 0.646609f, 0.661202f, 0.673626f, 0.683627f,
        0.690969f, 0.695458f, 0.696970f, 0.695458f, 0.690969f, 0.683627f, 0.673626f, 0.661202f, 0.646609f, 0.630104f,
        0.611932f, 0.592314f, 0.571450f, 0.549513f, 0.526652f, 0.502993f, 0.478647f, 0.453704f, 0.428244f, 0.402331f,
        0.376022f, 0.349366f, 0.322404f, 0.295169f, 0.267694f, 0.240004f, 0.212121f, 0.184066f, 0.155855f, 0.127504f,
        0.099026f, 0.070433f, 0.041734f, 0.012940f, 0.000000f, 0.000000f, 0.021817f, 0.050881f, 0.079865f, 0.108761f,
        0.137561f, 0.166254f, 0.194829f, 0.223272f, 0.251570f, 0.279705f, 0.307657f, 0.335403f, 0.362915f, 0.390163f,
        0.417110f, 0.443710f, 0.469913f, 0.495657f, 0.520867f, 0.545455f, 0.569313f, 0.592314f, 0.614305f, 0.635103f,
        0.654492f, 0.672223f, 0.688011f, 0.701550f, 0.712520f, 0.720620f, 0.725594f, 0.727273f, 0.725594f, 0.720620f,
        0.712520f, 0.701550f, 0.688011f, 0.672223f, 0.654492f, 0.635103f, 0.614305f, 0.592314f, 0.569313f, 0.545455f,
        0.520867f, 0.495657f, 0.469913f, 0.443710f, 0.417110f, 0.390163f, 0.362915f, 0.335403f, 0.307657f, 0.279705f,
        0.251570f, 0.223272f, 0.194829f, 0.166254f, 0.137561f, 0.108761f, 0.079865f, 0.050881f, 0.021817f, 0.000000f,
        0.000459f, 0.029830f, 0.059141f, 0.088387f, 0.117562f, 0.146659f, 0.175668f, 0.204581f, 0.233387f, 0.262073f,
        0.290624f, 0.319024f, 0.347253f, 0.375287f, 0.403100f, 0.430658f, 0.457923f, 0.484848f, 0.511378f, 0.537444f,
        0.562963f, 0.587834f, 0.611932f, 0.635103f, 0.657160f, 0.677874f, 0.696970f, 0.714122f, 0.728961f, 0.741091f,
        0.750115f, 0.755689f, 0.757576f, 0.755689f, 0.750115f, 0.741091f, 0.728961f, 0.714122f, 0.696970f, 0.677874f,
        0.657160f, 0.635103f, 0.611932f, 0.587834f, 0.562963f, 0.537444f, 0.511378f, 0.484848f, 0.457923f, 0.430658f,
        0.403100f, 0.375287f, 0.347253f, 0.319024f, 0.290624f, 0.262073f, 0.233387f, 0.204581f, 0.175668f, 0.146659f,
        0.117562f, 0.088387f, 0.059141f, 0.029830f, 0.000459f, 0.007373f, 0.036955f, 0.066490f, 0.095974f, 0.125402f,
        0.154768f, 0.184066f, 0.213288f, 0.242424f, 0.271466f, 0.300400f, 0.329214f, 0.357890f, 0.386410f, 0.414751f,
        0.442886f, 0.470780f, 0.498396f, 0.525683f, 0.552581f, 0.579017f, 0.604897f, 0.630104f, 0.654492f, 0.677874f,
        0.700015f, 0.720620f, 0.739323f, 0.755689f, 0.769219f, 0.779391f, 0.785725f, 0.787879f, 0.785725f, 0.779391f,
        0.769219f, 0.755689f, 0.739323f, 0.720620f, 0.700015f, 0.677874f, 0.654492f, 0.630104f, 0.604897f, 0.579017f,
        0.552581f, 0.525683f, 0.498396f, 0.470780f, 0.442886f, 0.414751f, 0.386410f, 0.357890f, 0.329214f, 0.300400f,
        0.271466f, 0.242424f, 0.213288f, 0.184066f, 0.154768f, 0.125402f, 0.095974f, 0.066490f, 0.036955f, 0.007373f,
        0.013405f, 0.043173f, 0.072906f, 0.102600f, 0.132253f, 0.161860f, 0.191414f, 0.220912f, 0.250344f, 0.279705f,
        0.308985f, 0.338172f, 0.367254f, 0.396216f, 0.425040f, 0.453704f, 0.482182f, 0.510440f, 0.538438f, 0.566127f,
        0.593442f, 0.620304f, 0.646609f, 0.672223f, 0.696970f, 0.720620f, 0.742870f, 0.763326f, 0.781482f, 0.796721f,
        0.808347f, 0.815674f, 0.818182f, 0.815674f, 0.808347f, 0.796721f, 0.781482f, 0.763326f, 0.742870f, 0.720620f,
        0.696970f, 0.672223f, 0.646609f, 0.620304f, 0.593442f, 0.566127f, 0.538438f, 0.510440f, 0.482182f, 0.453704f,
        0.425040f, 0.396216f, 0.367254f, 0.338172f, 0.308985f, 0.279705f, 0.250344f, 0.220912f, 0.191414f, 0.161860f,
        0.132253f, 0.102600f, 0.072906f, 0.043173f, 0.013405f, 0.018537f, 0.048466f, 0.078369f, 0.108246f, 0.138093f,
        0.167907f, 0.197685f, 0.227421f, 0.257112f, 0.286751f, 0.316333f, 0.345847f, 0.375287f, 0.404640f, 0.433893f,
        0.463029f, 0.492029f, 0.520867f, 0.549513f, 0.577928f, 0.606061f, 0.633847f, 0.661202f, 0.688011f, 0.714122f,
        0.739323f, 0.763326f, 0.785725f, 0.805966f, 0.823304f, 0.836813f, 0.845484f, 0.848485f, 0.845484f, 0.836813f,
        0.823304f, 0.805966f, 0.785725f, 0.763326f, 0.739323f, 0.714122f, 0.688011f, 0.661202f, 0.633847f, 0.606061f,
        0.577928f, 0.549513f, 0.520867f, 0.492029f, 0.463029f, 0.433893f, 0.404640f, 0.375287f, 0.345847f, 0.316333f,
        0.286751f, 0.257112f, 0.227421f, 0.197685f, 0.167907f, 0.138093f, 0.108246f, 0.078369f, 0.048466f, 0.018537f,
        0.022757f, 0.052818f, 0.082864f, 0.112892f, 0.142901f, 0.172888f, 0.202852f, 0.232789f, 0.262695f, 0.292569f,
        0.322404f, 0.352195f, 0.381937f, 0.411622f, 0.441240f, 0.470780f, 0.500230f, 0.529570f, 0.558781f, 0.587834f,
        0.616694f, 0.645312f, 0.673626f, 0.701550f, 0.728961f, 0.755689f, 0.781482f, 0.805966f, 0.828580f, 0.848485f,
        0.864481f, 0.875057f, 0.878788f, 0.875057f, 0.864481f, 0.848485f, 0.828580f, 0.805966f, 0.781482f, 0.755689f,
        0.728961f, 0.701550f, 0.673626f, 0.645312f, 0.616694f, 0.587834f, 0.558781f, 0.529570f, 0.500230f, 0.470780f,
        0.441240f, 0.411622f, 0.381937f, 0.352195f, 0.322404f, 0.292569f, 0.262695f, 0.232789f, 0.202852f, 0.172888f,
        0.142901f, 0.112892f, 0.082864f, 0.052818f, 0.022757f, 0.026051f, 0.056217f, 0.086375f, 0.116522f, 0.146659f,
        0.176783f, 0.206894f, 0.236989f, 0.267067f, 0.297126f, 0.327164f, 0.357176f, 0.387159f, 0.417110f, 0.447022f,
        0.476889f, 0.506702f, 0.536453f, 0.566127f, 0.595707f, 0.625172f, 0.654492f, 0.683627f, 0.712520f, 0.741091f,
        0.769219f, 0.796721f, 0.823304f, 0.848485f, 0.871435f, 0.890741f, 0.904173f, 0.909091f, 0.904173f, 0.890741f,
        0.871435f, 0.848485f, 0.823304f, 0.796721f, 0.769219f, 0.741091f, 0.712520f, 0.683627f, 0.654492f, 0.625172f,
        0.595707f, 0.566127f, 0.536453f, 0.506702f, 0.476889f, 0.447022f, 0.417110f, 0.387159f, 0.357176f, 0.327164f,
        0.297126f, 0.267067f, 0.236989f, 0.206894f, 0.176783f, 0.146659f, 0.116522f, 0.086375f, 0.056217f, 0.026051f,
        0.028411f, 0.058653f, 0.088891f, 0.119125f, 0.149353f, 0.179577f, 0.209794f, 0.240004f, 0.270206f, 0.300400f,
        0.330584f, 0.360757f, 0.390917f, 0.421061f, 0.451189f, 0.481296f, 0.511378f, 0.541432f, 0.571450f, 0.601426f,
        0.631348f, 0.661202f, 0.690969f, 0.720620f, 0.750115f, 0.779391f, 0.808347f, 0.836813f, 0.864481f, 0.890741f,
        0.914290f, 0.932240f, 0.939394f, 0.932240f, 0.914290f, 0.890741f, 0.864481f, 0.836813f, 0.808347f, 0.779391f,
        0.750115f, 0.720620f, 0.690969f, 0.661202f, 0.631348f, 0.601426f, 0.571450f, 0.541432f, 0.511378f, 0.481296f,
        0.451189f, 0.421061f, 0.390917f, 0.360757f, 0.330584f, 0.300400f, 0.270206f, 0.240004f, 0.209794f, 0.179577f,
        0.149353f, 0.119125f, 0.088891f, 0.058653f, 0.028411f, 0.029830f, 0.060117f, 0.090404f, 0.120690f, 0.150974f,
        0.181257f, 0.211539f, 0.241818f, 0.272096f, 0.302372f, 0.332645f, 0.362915f, 0.393182f, 0.423446f, 0.453704f,
        0.483958f, 0.514205f, 0.544446f, 0.574677f, 0.604897f, 0.635103f, 0.665292f, 0.695458f, 0.725594f, 0.755689f,
        0.785725f, 0.815674f, 0.845484f, 0.875057f, 0.904173f, 0.932240f, 0.957145f, 0.969697f, 0.957145f, 0.932240f,
        0.904173f, 0.875057f, 0.845484f, 0.815674f, 0.785725f, 0.755689f, 0.725594f, 0.695458f, 0.665292f, 0.635103f,
        0.604897f, 0.574677f, 0.544446f, 0.514205f, 0.483958f, 0.453704f, 0.423446f, 0.393182f, 0.362915f, 0.332645f,
        0.302372f, 0.272096f, 0.241818f, 0.211539f, 0.181257f, 0.150974f, 0.120690f, 0.090404f, 0.060117f, 0.029830f,
        0.030303f, 0.060606f, 0.090909f, 0.121212f, 0.151515f, 0.181818f, 0.212121f, 0.242424f, 0.272727f, 0.303030f,
        0.333333f, 0.363636f, 0.393939f, 0.424242f, 0.454545f, 0.484848f, 0.515152f, 0.545455f, 0.575758f, 0.606061f,
        0.636364f, 0.666667f, 0.696970f, 0.727273f, 0.757576f, 0.787879f, 0.818182f, 0.848485f, 0.878788f, 0.909091f,
        0.939394f, 0.969697f, 1.000000f, 0.969697f, 0.939394f, 0.909091f, 0.878788f, 0.848485f, 0.818182f, 0.787879f,
        0.757576f, 0.727273f, 0.696970f, 0.666667f, 0.636364f, 0.606061f, 0.575758f, 0.545455f, 0.515152f, 0.484848f,
        0.454545f, 0.424242f, 0.393939f, 0.363636f, 0.333333f, 0.303030f, 0.272727f, 0.242424f, 0.212121f, 0.181818f,
        0.151515f, 0.121212f, 0.090909f, 0.060606f, 0.030303f, 0.029830f, 0.060117f, 0.090404f, 0.120690f, 0.150974f,
        0.181257f, 0.211539f, 0.241818f, 0.272096f, 0.302372f, 0.332645f, 0.362915f, 0.393182f, 0.423446f, 0.453704f,
        0.483958f, 0.514205f, 0.544446f, 0.574677f, 0.604897f, 0.635103f, 0.665292f, 0.695458f, 0.725594f, 0.755689f,
        0.785725f, 0.815674f, 0.845484f, 0.875057f, 0.904173f, 0.932240f, 0.957145f, 0.969697f, 0.957145f, 0.932240f,
        0.904173f, 0.875057f, 0.845484f, 0.815674f, 0.785725f, 0.755689f, 0.725594f, 0.695458f, 0.665292f, 0.635103f,
        0.604897f, 0.574677f, 0.544446f, 0.514205f, 0.483958f, 0.453704f, 0.423446f, 0.393182f, 0.362915f, 0.332645f,
        0.302372f, 0.272096f, 0.241818f, 0.211539f, 0.181257f, 0.150974f, 0.120690f, 0.090404f, 0.060117f, 0.029830f,
        0.028411f, 0.058653f, 0.088891f, 0.119125f, 0.149353f, 0.179577f, 0.209794f, 0.240004f, 0.270206f, 0.300400f,
        0.330584f, 0.360757f, 0.390917f, 0.421061f, 0.451189f, 0.481296f, 0.511378f, 0.541432f, 0.571450f, 0.601426f,
        0.631348f, 0.661202f, 0.690969f, 0.720620f, 0.750115f, 0.779391f, 0.808347f, 0.836813f, 0.864481f, 0.890741f,
        0.914290f, 0.932240f, 0.939394f, 0.932240f, 0.914290f, 0.890741f, 0.864481f, 0.836813f, 0.808347f, 0.779391f,
        0.750115f, 0.720620f, 0.690969f, 0.661202f, 0.631348f, 0.601426f, 0.571450f, 0.541432f, 0.511378f, 0.481296f,
        0.451189f, 0.421061f, 0.390917f, 0.360757f, 0.330584f, 0.300400f, 0.270206f, 0.240004f, 0.209794f, 0.179577f,
        0.149353f, 0.119125f, 0.088891f, 0.058653f, 0.028411f, 0.026051f, 0.056217f, 0.086375f, 0.116522f, 0.146659f,
        0.176783f, 0.206894f, 0.236989f, 0.267067f, 0.297126f, 0.327164f, 0.357176f, 0.387159f, 0.417110f, 0.447022f,
        0.476889f, 0.506702f, 0.536453f, 0.566127f, 0.595707f, 0.625172f, 0.654492f, 0.683627f, 0.712520f, 0.741091f,
        0.769219f, 0.796721f, 0.823304f, 0.848485f, 0.871435f, 0.890741f, 0.904173f, 0.909091f, 0.904173f, 0.890741f,
        0.871435f, 0.848485f, 0.823304f, 0.796721f, 0.769219f, 0.741091f, 0.712520f, 0.683627f, 0.654492f, 0.625172f,
        0.595707f, 0.566127f, 0.536453f, 0.506702f, 0.476889f, 0.447022f, 0.417110f, 0.387159f, 0.357176f, 0.327164f,
        0.297126f, 0.267067f, 0.236989f, 0.206894f, 0.176783f, 0.146659f, 0.116522f, 0.086375f, 0.056217f, 0.026051f,
        0.022757f, 0.052818f, 0.082864f, 0.112892f, 0.142901f, 0.172888f, 0.202852f, 0.232789f, 0.262695f, 0.292569f,
        0.322404f, 0.352195f, 0.381937f, 0.411622f, 0.441240f, 0.470780f, 0.500230f, 0.529570f, 0.558781f, 0.587834f,
        0.616694f, 0.645312f, 0.673626f, 0.701550f, 0.728961f, 0.755689f, 0.781482f, 0.805966f, 0.828580f, 0.848485f,
        0.864481f, 0.875057f, 0.878788f, 0.875057f, 0.864481f, 0.848485f, 0.828580f, 0.805966f, 0.781482f, 0.755689f,
        0.728961f, 0.701550f, 0.673626f, 0.645312f, 0.616694f, 0.587834f, 0.558781f, 0.529570f, 0.500230f, 0.470780f,
        0.441240f, 0.411622f, 0.381937f, 0.352195f, 0.322404f, 0.292569f, 0.262695f, 0.232789f, 0.202852f, 0.172888f,
        0.142901f, 0.112892f, 0.082864f, 0.052818f, 0.022757f, 0.018537f, 0.048466f, 0.078369f, 0.108246f, 0.138093f,
        0.167907f, 0.197685f, 0.227421f, 0.257112f, 0.286751f, 0.316333f, 0.345847f, 0.375287f, 0.404640f, 0.433893f,
        0.463029f, 0.492029f, 0.520867f, 0.549513f, 0.577928f, 0.606061f, 0.633847f, 0.661202f, 0.688011f, 0.714122f,
        0.739323f, 0.763326f, 0.785725f, 0.805966f, 0.823304f, 0.836813f, 0.845484f, 0.848485f, 0.845484f, 0.836813f,
        0.823304f, 0.805966f, 0.785725f, 0.763326f, 0.739323f, 0.714122f, 0.688011f, 0.661202f, 0.633847f, 0.606061f,
        0.577928f, 0.549513f, 0.520867f, 0.492029f, 0.463029f, 0.433893f, 0.404640f, 0.375287f, 0.345847f, 0.316333f,
        0.286751f, 0.257112f, 0.227421f, 0.197685f, 0.167907f, 0.138093f, 0.108246f, 0.078369f, 0.048466f, 0.018537f,
        0.013405f, 0.043173f, 0.072906f, 0.102600f, 0.132253f, 0.161860f, 0.191414f, 0.220912f, 0.250344f, 0.279705f,
        0.308985f, 0.338172f, 0.367254f, 0.396216f, 0.425040f, 0.453704f, 0.482182f, 0.510440f, 0.538438f, 0.566127f,
        0.593442f, 0.620304f, 0.646609f, 0.672223f, 0.696970f, 0.720620f, 0.742870f, 0.763326f, 0.781482f, 0.796721f,
        0.808347f, 0.815674f, 0.818182f, 0.815674f, 0.808347f, 0.796721f, 0.781482f, 0.763326f, 0.742870f, 0.720620f,
        0.696970f, 0.672223f, 0.646609f, 0.620304f, 0.593442f, 0.566127f, 0.538438f, 0.510440f, 0.482182f, 0.453704f,
        0.425040f, 0.396216f, 0.367254f, 0.338172f, 0.308985f, 0.279705f, 0.250344f, 0.220912f, 0.191414f, 0.161860f,
        0.132253f, 0.102600f, 0.072906f, 0.043173f, 0.013405f, 0.007373f, 0.036955f, 0.066490f, 0.095974f, 0.125402f,
        0.154768f, 0.184066f, 0.213288f, 0.242424f, 0.271466f, 0.300400f, 0.329214f, 0.357890f, 0.386410f, 0.414751f,
        0.442886f, 0.470780f, 0.498396f, 0.525683f, 0.552581f, 0.579017f, 0.604897f, 0.630104f, 0.654492f, 0.677874f,
        0.700015f, 0.720620f, 0.739323f, 0.755689f, 0.769219f, 0.779391f, 0.785725f, 0.787879f, 0.785725f, 0.779391f,
        0.769219f, 0.755689f, 0.739323f, 0.720620f, 0.700015f, 0.677874f, 0.654492f, 0.630104f, 0.604897f, 0.579017f,
        0.552581f, 0.525683f, 0.498396f, 0.470780f, 0.442886f, 0.414751f, 0.386410f, 0.357890f, 0.329214f, 0.300400f,
        0.271466f, 0.242424f, 0.213288f, 0.184066f, 0.154768f, 0.125402f, 0.095974f, 0.066490f, 0.036955f, 0.007373f,
        0.000459f, 0.029830f, 0.059141f, 0.088387f, 0.117562f, 0.146659f, 0.175668f, 0.204581f, 0.233387f, 0.262073f,
        0.290624f, 0.319024f, 0.347253f, 0.375287f, 0.403100f, 0.430658f, 0.457923f, 0.484848f, 0.511378f, 0.537444f,
        0.562963f, 0.587834f, 0.611932f, 0.635103f, 0.657160f, 0.677874f, 0.696970f, 0.714122f, 0.728961f, 0.741091f,
        0.750115f, 0.755689f, 0.757576f, 0.755689f, 0.750115f, 0.741091f, 0.728961f, 0.714122f, 0.696970f, 0.677874f,
        0.657160f, 0.635103f, 0.611932f, 0.587834f, 0.562963f, 0.537444f, 0.511378f, 0.484848f, 0.457923f, 0.430658f,
        0.403100f, 0.375287f, 0.347253f, 0.319024f, 0.290624f, 0.262073f, 0.233387f, 0.204581f, 0.175668f, 0.146659f,
        0.117562f, 0.088387f, 0.059141f, 0.029830f, 0.000459f, 0.000000f, 0.021817f, 0.050881f, 0.079865f, 0.108761f,
        0.137561f, 0.166254f, 0.194829f, 0.223272f, 0.251570f, 0.279705f, 0.307657f, 0.335403f, 0.362915f, 0.390163f,
        0.417110f, 0.443710f, 0.469913f, 0.495657f, 0.520867f, 0.545455f, 0.569313f, 0.592314f, 0.614305f, 0.635103f,
        0.654492f, 0.672223f, 0.688011f, 0.701550f, 0.712520f, 0.720620f, 0.725594f, 0.727273f, 0.725594f, 0.720620f,
        0.712520f, 0.701550f, 0.688011f, 0.672223f, 0.654492f, 0.635103f, 0.614305f, 0.592314f, 0.569313f, 0.545455f,
        0.520867f, 0.495657f, 0.469913f, 0.443710f, 0.417110f, 0.390163f, 0.362915f, 0.335403f, 0.307657f, 0.279705f,
        0.251570f, 0.223272f, 0.194829f, 0.166254f, 0.137561f, 0.108761f, 0.079865f, 0.050881f, 0.021817f, 0.000000f,
        0.000000f, 0.012940f, 0.041734f, 0.070433f, 0.099026f, 0.127504f, 0.155855f, 0.184066f, 0.212121f, 0.240004f,
        0.267694f, 0.295169f, 0.322404f, 0.349366f, 0.376022f, 0.402331f, 0.428244f, 0.453704f, 0.478647f, 0.502993f,
        0.526652f, 0.549513f, 0.571450f, 0.592314f, 0.611932f, 0.630104f, 0.646609f, 0.661202f, 0.673626f, 0.683627f,
        0.690969f, 0.695458f, 0.696970f, 0.695458f, 0.690969f, 0.683627f, 0.673626f, 0.661202f, 0.646609f, 0.630104f,
        0.611932f, 0.592314f, 0.571450f, 0.549513f, 0.526652f, 0.502993f, 0.478647f, 0.453704f, 0.428244f, 0.402331f,
        0.376022f, 0.349366f, 0.322404f, 0.295169f, 0.267694f, 0.240004f, 0.212121f, 0.184066f, 0.155855f, 0.127504f,
        0.099026f, 0.070433f, 0.041734f, 0.012940f, 0.000000f, 0.000000f, 0.003219f, 0.031725f, 0.060117f, 0.088387f,
        0.116522f, 0.144509f, 0.172333f, 0.199977f, 0.227421f, 0.254644f, 0.281620f, 0.308320f, 0.334712f, 0.360757f,
        0.386410f, 0.411622f, 0.436331f, 0.460470f, 0.483958f, 0.506702f, 0.528595f, 0.549513f, 0.569313f, 0.587834f,
        0.604897f, 0.620304f, 0.633847f, 0.645312f, 0.654492f, 0.661202f, 0.665292f, 0.666667f, 0.665292f, 0.661202f,
        0.654492f, 0.645312f, 0.633847f, 0.620304f, 0.604897f, 0.587834f, 0.569313f, 0.549513f, 0.528595f, 0.506702f,
        0.483958f, 0.460470f, 0.436331f, 0.411622f, 0.386410f, 0.360757f, 0.334712f, 0.308320f, 0.281620f, 0.254644f,
        0.227421f, 0.199977f, 0.172333f, 0.144509f, 0.116522f, 0.088387f, 0.060117f, 0.031725f, 0.003219f, 0.000000f,
        0.000000f, 0.000000f, 0.020879f, 0.048948f, 0.076876f, 0.104649f, 0.132253f, 0.159671f, 0.186884f, 0.213871f,
        0.240608f, 0.267067f, 0.293218f, 0.319024f, 0.344445f, 0.369435f, 0.393939f, 0.417898f, 0.441240f, 0.463885f,
        0.485741f, 0.506702f, 0.526652f, 0.545455f, 0.562963f, 0.579017f, 0.593442f, 0.606061f, 0.616694f, 0.625172f,
        0.631348f, 0.635103f, 0.636364f, 0.635103f, 0.631348f, 0.625172f, 0.616694f, 0.606061f, 0.593442f, 0.579017f,
        0.562963f, 0.545455f, 0.526652f, 0.506702f, 0.485741f, 0.463885f, 0.441240f, 0.417898f, 0.393939f, 0.369435f,
        0.344445f, 0.319024f, 0.293218f, 0.267067f, 0.240608f, 0.213871f, 0.186884f, 0.159671f, 0.132253f, 0.104649f,
        0.076876f, 0.048948f, 0.020879f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.009225f, 0.036955f, 0.064524f,
        0.091920f, 0.119125f, 0.146121f, 0.172888f, 0.199403f, 0.225640f, 0.251570f, 0.277160f, 0.302372f, 0.327164f,
        0.351487f, 0.375287f, 0.398502f, 0.421061f, 0.442886f, 0.463885f, 0.483958f, 0.502993f, 0.520867f, 0.537444f,
        0.552581f, 0.566127f, 0.577928f, 0.587834f, 0.595707f, 0.601426f, 0.604897f, 0.606061f, 0.604897f, 0.601426f,
        0.595707f, 0.587834f, 0.577928f, 0.566127f, 0.552581f, 0.537444f, 0.520867f, 0.502993f, 0.483958f, 0.463885f,
        0.442886f, 0.421061f, 0.398502f, 0.375287f, 0.351487f, 0.327164f, 0.302372f, 0.277160f, 0.251570f, 0.225640f,
        0.199403f, 0.172888f, 0.146121f, 0.119125f, 0.091920f, 0.064524f, 0.036955f, 0.009225f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.024167f, 0.051365f, 0.078369f, 0.105162f, 0.131724f, 0.158034f, 0.184066f,
        0.209794f, 0.235186f, 0.260209f, 0.284823f, 0.308985f, 0.332645f, 0.355749f, 0.378234f, 0.400031f, 0.421061f,
        0.441240f, 0.460470f, 0.478647f, 0.495657f, 0.511378f, 0.525683f, 0.538438f, 0.549513f, 0.558781f, 0.566127f,
        0.571450f, 0.574677f, 0.575758f, 0.574677f, 0.571450f, 0.566127f, 0.558781f, 0.549513f, 0.538438f, 0.525683f,
        0.511378f, 0.495657f, 0.478647f, 0.460470f, 0.441240f, 0.421061f, 0.400031f, 0.378234f, 0.355749f, 0.332645f,
        0.308985f, 0.284823f, 0.260209f, 0.235186f, 0.209794f, 0.184066f, 0.158034f, 0.131724f, 0.105162f, 0.078369f,
        0.051365f, 0.024167f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.010617f, 0.037431f,
        0.064034f, 0.090404f, 0.116522f, 0.142365f, 0.167907f, 0.193120f, 0.217970f, 0.242424f, 0.266441f, 0.289977f,
        0.312983f, 0.335403f, 0.357176f, 0.378234f, 0.398502f, 0.417898f, 0.436331f, 0.453704f, 0.469913f, 0.484848f,
        0.498396f, 0.510440f, 0.520867f, 0.529570f, 0.536453f, 0.541432f, 0.544446f, 0.545455f, 0.544446f, 0.541432f,
        0.536453f, 0.529570f, 0.520867f, 0.510440f, 0.498396f, 0.484848f, 0.469913f, 0.453704f, 0.436331f, 0.417898f,
        0.398502f, 0.378234f, 0.357176f, 0.335403f, 0.312983f, 0.289977f, 0.266441f, 0.242424f, 0.217970f, 0.193120f,
        0.167907f, 0.142365f, 0.116522f, 0.090404f, 0.064034f, 0.037431f, 0.010617f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.022757f, 0.048948f, 0.074889f, 0.100556f, 0.125927f, 0.150974f,
        0.175668f, 0.199977f, 0.223864f, 0.247288f, 0.270206f, 0.292569f, 0.314321f, 0.335403f, 0.355749f, 0.375287f,
        0.393939f, 0.411622f, 0.428244f, 0.443710f, 0.457923f, 0.470780f, 0.482182f, 0.492029f, 0.500230f, 0.506702f,
        0.511378f, 0.514205f, 0.515152f, 0.514205f, 0.511378f, 0.506702f, 0.500230f, 0.492029f, 0.482182f, 0.470780f,
        0.457923f, 0.443710f, 0.428244f, 0.411622f, 0.393939f, 0.375287f, 0.355749f, 0.335403f, 0.314321f, 0.292569f,
        0.270206f, 0.247288f, 0.223864f, 0.199977f, 0.175668f, 0.150974f, 0.125927f, 0.100556f, 0.074889f, 0.048948f,
        0.022757f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.007373f,
        0.033148f, 0.058653f, 0.083866f, 0.108761f, 0.133312f, 0.157489f, 0.181257f, 0.204581f, 0.227421f, 0.249732f,
        0.271466f, 0.292569f, 0.312983f, 0.332645f, 0.351487f, 0.369435f, 0.386410f, 0.402331f, 0.417110f, 0.430658f,
        0.442886f, 0.453704f, 0.463029f, 0.470780f, 0.476889f, 0.481296f, 0.483958f, 0.484848f, 0.483958f, 0.481296f,
        0.476889f, 0.470780f, 0.463029f, 0.453704f, 0.442886f, 0.430658f, 0.417110f, 0.402331f, 0.386410f, 0.369435f,
        0.351487f, 0.332645f, 0.312983f, 0.292569f, 0.271466f, 0.249732f, 0.227421f, 0.204581f, 0.181257f, 0.157489f,
        0.133312f, 0.108761f, 0.083866f, 0.058653f, 0.033148f, 0.007373f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.016668f, 0.041734f, 0.066490f, 0.090909f, 0.114965f,
        0.138626f, 0.161860f, 0.184629f, 0.206894f, 0.228611f, 0.249732f, 0.270206f, 0.289977f, 0.308985f, 0.327164f,
        0.344445f, 0.360757f, 0.376022f, 0.390163f, 0.403100f, 0.414751f, 0.425040f, 0.433893f, 0.441240f, 0.447022f,
        0.451189f, 0.453704f, 0.454545f, 0.453704f, 0.451189f, 0.447022f, 0.441240f, 0.433893f, 0.425040f, 0.414751f,
        0.403100f, 0.390163f, 0.376022f, 0.360757f, 0.344445f, 0.327164f, 0.308985f, 0.289977f, 0.270206f, 0.249732f,
        0.228611f, 0.206894f, 0.184629f, 0.161860f, 0.138626f, 0.114965f, 0.090909f, 0.066490f, 0.041734f, 0.016668f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.024167f, 0.048466f, 0.072410f, 0.095974f, 0.119125f, 0.141830f, 0.164054f, 0.185756f, 0.206894f,
        0.227421f, 0.247288f, 0.266441f, 0.284823f, 0.302372f, 0.319024f, 0.334712f, 0.349366f, 0.362915f, 0.375287f,
        0.386410f, 0.396216f, 0.404640f, 0.411622f, 0.417110f, 0.421061f, 0.423446f, 0.424242f, 0.423446f, 0.421061f,
        0.417110f, 0.411622f, 0.404640f, 0.396216f, 0.386410f, 0.375287f, 0.362915f, 0.349366f, 0.334712f, 0.319024f,
        0.302372f, 0.284823f, 0.266441f, 0.247288f, 0.227421f, 0.206894f, 0.185756f, 0.164054f, 0.141830f, 0.119125f,
        0.095974f, 0.072410f, 0.048466f, 0.024167f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.005987f, 0.029830f, 0.053303f, 0.076379f,
        0.099026f, 0.121212f, 0.142901f, 0.164054f, 0.184629f, 0.204581f, 0.223864f, 0.242424f, 0.260209f, 0.277160f,
        0.293218f, 0.308320f, 0.322404f, 0.335403f, 0.347253f, 0.357890f, 0.367254f, 0.375287f, 0.381937f, 0.387159f,
        0.390917f, 0.393182f, 0.393939f, 0.393182f, 0.390917f, 0.387159f, 0.381937f, 0.375287f, 0.367254f, 0.357890f,
        0.347253f, 0.335403f, 0.322404f, 0.308320f, 0.293218f, 0.277160f, 0.260209f, 0.242424f, 0.223864f, 0.204581f,
        0.184629f, 0.164054f, 0.142901f, 0.121212f, 0.099026f, 0.076379f, 0.053303f, 0.029830f, 0.005987f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.010617f, 0.033623f, 0.056217f, 0.078369f, 0.100046f, 0.121212f, 0.141830f, 0.161860f,
        0.181257f, 0.199977f, 0.217970f, 0.235186f, 0.251570f, 0.267067f, 0.281620f, 0.295169f, 0.307657f, 0.319024f,
        0.329214f, 0.338172f, 0.345847f, 0.352195f, 0.357176f, 0.360757f, 0.362915f, 0.363636f, 0.362915f, 0.360757f,
        0.357176f, 0.352195f, 0.345847f, 0.338172f, 0.329214f, 0.319024f, 0.307657f, 0.295169f, 0.281620f, 0.267067f,
        0.251570f, 0.235186f, 0.217970f, 0.199977f, 0.181257f, 0.161860f, 0.141830f, 0.121212f, 0.100046f, 0.078369f,
        0.056217f, 0.033623f, 0.010617f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.013405f, 0.035525f,
        0.057191f, 0.078369f, 0.099026f, 0.119125f, 0.138626f, 0.157489f, 0.175668f, 0.193120f, 0.209794f, 0.225640f,
        0.240608f, 0.254644f, 0.267694f, 0.279705f, 0.290624f, 0.300400f, 0.308985f, 0.316333f, 0.322404f, 0.327164f,
        0.330584f, 0.332645f, 0.333333f, 0.332645f, 0.330584f, 0.327164f, 0.322404f, 0.316333f, 0.308985f, 0.300400f,
        0.290624f, 0.279705f, 0.267694f, 0.254644f, 0.240608f, 0.225640f, 0.209794f, 0.193120f, 0.175668f, 0.157489f,
        0.138626f, 0.119125f, 0.099026f, 0.078369f, 0.057191f, 0.035525f, 0.013405f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.014336f, 0.035525f, 0.056217f, 0.076379f, 0.095974f, 0.114965f,
        0.133312f, 0.150974f, 0.167907f, 0.184066f, 0.199403f, 0.213871f, 0.227421f, 0.240004f, 0.251570f, 0.262073f,
        0.271466f, 0.279705f, 0.286751f, 0.292569f, 0.297126f, 0.300400f, 0.302372f, 0.303030f, 0.302372f, 0.300400f,
        0.297126f, 0.292569f, 0.286751f, 0.279705f, 0.271466f, 0.262073f, 0.251570f, 0.240004f, 0.227421f, 0.213871f,
        0.199403f, 0.184066f, 0.167907f, 0.150974f, 0.133312f, 0.114965f, 0.095974f, 0.076379f, 0.056217f, 0.035525f,
        0.014336f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.013405f, 0.033623f, 0.053303f, 0.072410f, 0.090909f, 0.108761f, 0.125927f, 0.142365f, 0.158034f, 0.172888f,
        0.186884f, 0.199977f, 0.212121f, 0.223272f, 0.233387f, 0.242424f, 0.250344f, 0.257112f, 0.262695f, 0.267067f,
        0.270206f, 0.272096f, 0.272727f, 0.272096f, 0.270206f, 0.267067f, 0.262695f, 0.257112f, 0.250344f, 0.242424f,
        0.233387f, 0.223272f, 0.212121f, 0.199977f, 0.186884f, 0.172888f, 0.158034f, 0.142365f, 0.125927f, 0.108761f,
        0.090909f, 0.072410f, 0.053303f, 0.033623f, 0.013405f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.010617f, 0.029830f, 0.048466f, 0.066490f,
        0.083866f, 0.100556f, 0.116522f, 0.131724f, 0.146121f, 0.159671f, 0.172333f, 0.184066f, 0.194829f, 0.204581f,
        0.213288f, 0.220912f, 0.227421f, 0.232789f, 0.236989f, 0.240004f, 0.241818f, 0.242424f, 0.241818f, 0.240004f,
        0.236989f, 0.232789f, 0.227421f, 0.220912f, 0.213288f, 0.204581f, 0.194829f, 0.184066f, 0.172333f, 0.159671f,
        0.146121f, 0.131724f, 0.116522f, 0.100556f, 0.083866f, 0.066490f, 0.048466f, 0.029830f, 0.010617f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.005987f, 0.024167f, 0.041734f, 0.058653f, 0.074889f, 0.090404f, 0.105162f, 0.119125f,
        0.132253f, 0.144509f, 0.155855f, 0.166254f, 0.175668f, 0.184066f, 0.191414f, 0.197685f, 0.202852f, 0.206894f,
        0.209794f, 0.211539f, 0.212121f, 0.211539f, 0.209794f, 0.206894f, 0.202852f, 0.197685f, 0.191414f, 0.184066f,
        0.175668f, 0.166254f, 0.155855f, 0.144509f, 0.132253f, 0.119125f, 0.105162f, 0.090404f, 0.074889f, 0.058653f,
        0.041734f, 0.024167f, 0.005987f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.016668f,
        0.033148f, 0.048948f, 0.064034f, 0.078369f, 0.091920f, 0.104649f, 0.116522f, 0.127504f, 0.137561f, 0.146659f,
        0.154768f, 0.161860f, 0.167907f, 0.172888f, 0.176783f, 0.179577f, 0.181257f, 0.181818f, 0.181257f, 0.179577f,
        0.176783f, 0.172888f, 0.167907f, 0.161860f, 0.154768f, 0.146659f, 0.137561f, 0.127504f, 0.116522f, 0.104649f,
        0.091920f, 0.078369f, 0.064034f, 0.048948f, 0.033148f, 0.016668f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.007373f, 0.022757f, 0.037431f, 0.051365f, 0.064524f,
        0.076876f, 0.088387f, 0.099026f, 0.108761f, 0.117562f, 0.125402f, 0.132253f, 0.138093f, 0.142901f, 0.146659f,
        0.149353f, 0.150974f, 0.151515f, 0.150974f, 0.149353f, 0.146659f, 0.142901f, 0.138093f, 0.132253f, 0.125402f,
        0.117562f, 0.108761f, 0.099026f, 0.088387f, 0.076876f, 0.064524f, 0.051365f, 0.037431f, 0.022757f, 0.007373f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.010617f, 0.024167f, 0.036955f, 0.048948f, 0.060117f, 0.070433f, 0.079865f, 0.088387f,
        0.095974f, 0.102600f, 0.108246f, 0.112892f, 0.116522f, 0.119125f, 0.120690f, 0.121212f, 0.120690f, 0.119125f,
        0.116522f, 0.112892f, 0.108246f, 0.102600f, 0.095974f, 0.088387f, 0.079865f, 0.070433f, 0.060117f, 0.048948f,
        0.036955f, 0.024167f, 0.010617f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.009225f,
        0.020879f, 0.031725f, 0.041734f, 0.050881f, 0.059141f, 0.066490f, 0.072906f, 0.078369f, 0.082864f, 0.086375f,
        0.088891f, 0.090404f, 0.090909f, 0.090404f, 0.088891f, 0.086375f, 0.082864f, 0.078369f, 0.072906f, 0.066490f,
        0.059141f, 0.050881f, 0.041734f, 0.031725f, 0.020879f, 0.009225f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.003219f, 0.012940f, 0.021817f, 0.029830f,
        0.036955f, 0.043173f, 0.048466f, 0.052818f, 0.056217f, 0.058653f, 0.060117f, 0.060606f, 0.060117f, 0.058653f,
        0.056217f, 0.052818f, 0.048466f, 0.043173f, 0.036955f, 0.029830f, 0.021817f, 0.012940f, 0.003219f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000459f, 0.007373f, 0.013405f, 0.018537f, 0.022757f, 0.026051f,
        0.028411f, 0.029830f, 0.030303f, 0.029830f, 0.028411f, 0.026051f, 0.022757f, 0.018537f, 0.013405f, 0.007373f,
        0.000459f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
        0.000000f, 0.000000f, 0.000000f, 0.000000f, 0.000000f,
};

static heatmap_stamp_t stamp_default_4 = {
        stamp_default_4_data, 65, 65
};


void heatmap_init(heatmap_t *hm, unsigned w, unsigned h) {
    memset(hm, 0, sizeof(heatmap_t));
    hm->buf = (float *) calloc(w * h, sizeof(float));
    hm->w = w;
    hm->h = h;
}

heatmap_t *heatmap_new(unsigned w, unsigned h) {
    heatmap_t *hm = (heatmap_t *) malloc(sizeof(heatmap_t));
    heatmap_init(hm, w, h);
    return hm;
}

void heatmap_free(heatmap_t *h) {
    free(h->buf);
    free(h);
}

void heatmap_add_point(heatmap_t *h, unsigned x, unsigned y) {
    heatmap_add_point_with_stamp(h, x, y, &stamp_default_4);
}

void heatmap_add_point_with_stamp(heatmap_t *h, unsigned x, unsigned y, const heatmap_stamp_t *stamp) {
    /* I'm still unsure whether we want this to be an assert or not... */
    if (x >= h->w || y >= h->h)
        return;

    /* I hate you, C */
    {
        /* Note: the order of operations is important, since we're computing with unsigned! */

        /* These are [first, last) pairs in the STAMP's pixels. */
        const unsigned x0 = x < stamp->w / 2 ? (stamp->w / 2 - x) : 0;
        const unsigned y0 = y < stamp->h / 2 ? (stamp->h / 2 - y) : 0;
        const unsigned x1 = (x + stamp->w / 2) < h->w ? stamp->w : stamp->w / 2 + (h->w - x);
        const unsigned y1 = (y + stamp->h / 2) < h->h ? stamp->h : stamp->h / 2 + (h->h - y);

        unsigned iy;

        for (iy = y0; iy < y1; ++iy) {
            /* TODO: could it be clearer by using separate vars and computing a ystep? */
            float *line = h->buf + ((y + iy) - stamp->h / 2) * h->w + (x + x0) - stamp->w / 2;
            const float *stampline = stamp->buf + iy * stamp->w + x0;

            unsigned ix;
            for (ix = x0; ix < x1; ++ix, ++line, ++stampline) {
                /* TODO: Let's actually accept negatives and try out funky stamps. */
                /* Note that that might mess with the max though. */
                /* And that we'll have to clamp the bottom to 0 when rendering. */
                assert(*stampline >= 0.0f);

                *line += *stampline;
                if (*line > h->max) { h->max = *line; }

                assert(*line >= 0.0f);
            }
        }
    } /* I hate you very much! */
}

unsigned char *heatmap_render_default_to(const heatmap_t *h, unsigned char *colorbuf) {
    return heatmap_render_to(h, heatmap_cs_default, colorbuf);
}

unsigned char *
heatmap_render_to(const heatmap_t *h, const heatmap_colorscheme_t *colorscheme, unsigned char *colorbuf) {
    /* TODO: Time whether it makes a noticeable difference to inline that code
     * here and drop the saturation step.
     */
    /* If the heatmap is empty, h->max (and thus the saturation value) is 0.0, resulting in a 0-by-0 division.
     * In that case, we should set the saturation to anything but 0, since we want the result of the division to be 0.
     * Also, a comparison to exact 0.0f (as opposed to 1e-14) is OK, since we only do division.
     */
    return heatmap_render_saturated_to(h, colorscheme, h->max > 0.0f ? h->max : 1.0f, colorbuf);
}

unsigned char *
heatmap_render_saturated_to(const heatmap_t *h, const heatmap_colorscheme_t *colorscheme, float saturation,
                            unsigned char *colorbuf) {
    unsigned y;
    assert(saturation > 0.0f);

    /* malloc */
    if (!colorbuf) {
        colorbuf = (unsigned char *) malloc(h->w * h->h * 4);
        if (!colorbuf) {
            return 0;
        }
    }

    /* TODO: could actually even flatten this loop before parallelizing it. */
    /* I.e., to go i = 0 ; i < h*w since I don't have any padding! (yet?) */
    for (y = 0; y < h->h; ++y) {
        float *bufline = h->buf + y * h->w;
        unsigned char *colorline = colorbuf + 4 * y * h->w;

        unsigned x;
        for (x = 0; x < h->w; ++x, ++bufline) {
            /* Saturate the heat value to the given saturation, and then
             * normalize by that.
             */
            const float val = (*bufline > saturation ? saturation : *bufline) / saturation;

            /* We add 0.5 in order to do real rounding, not just dropping the
             * decimal part. That way we are certain the highest value in the
             * colorscheme is actually used.
             */
            const size_t idx = (size_t) ((float) (colorscheme->ncolors - 1) * val);
            /* This is probably caused by a negative entry in the stamp! */
            assert(val >= 0.0f);
            /* This should never happen. It is likely a bug in this library. */
            assert(idx < colorscheme->ncolors);
            /* Just copy over the color from the colorscheme. */
            if (idx != 0)
                memcpy(colorline, colorscheme->colors + idx * 4, 4);

            colorline += 4;
        }
    }

    return colorbuf;
}

void heatmap_stamp_init(heatmap_stamp_t *stamp, unsigned w, unsigned h, float *data) {
    if (stamp) {
        memset(stamp, 0, sizeof(heatmap_stamp_t));
        stamp->w = w;
        stamp->h = h;
        stamp->buf = data;
    }
}

heatmap_stamp_t *heatmap_stamp_new_with(unsigned w, unsigned h, float *data) {
    heatmap_stamp_t *stamp = (heatmap_stamp_t *) malloc(sizeof(heatmap_stamp_t));
    heatmap_stamp_init(stamp, w, h, data);
    return stamp;
}

heatmap_stamp_t *heatmap_stamp_load(unsigned w, unsigned h, float *data) {
    float *copy = (float *) malloc(sizeof(float) * w * h);
    memcpy(copy, data, sizeof(float) * w * h);
    return heatmap_stamp_new_with(w, h, copy);
}

static float linear_dist(float dist) {
    return dist;
}

heatmap_stamp_t *heatmap_stamp_gen(unsigned r) {
    return heatmap_stamp_gen_nonlinear(r, linear_dist);
}

heatmap_stamp_t *heatmap_stamp_gen_nonlinear(unsigned r, float (*distshape)(float)) {
    unsigned y;
    unsigned d = 2 * r + 1;

    float *stamp = (float *) calloc(d * d, sizeof(float));
    if (!stamp)
        return 0;

    for (y = 0; y < d; ++y) {
        float *line = stamp + y * d;
        unsigned x;
        for (x = 0; x < d; ++x, ++line) {
            const float dist = sqrtf((float) ((x - r) * (x - r) + (y - r) * (y - r))) / (float) (r + 1);
            const float ds = (*distshape)(dist);
            /* This doesn't generate optimal assembly, but meh, it's readable. */
            const float clamped_ds = ds > 1.0f ? 1.0f
                                               : ds < 0.0f ? 0.0f
                                                           : ds;
            *line = 1.0f - clamped_ds;
        }
    }

    return heatmap_stamp_new_with(d, d, stamp);
}

void heatmap_stamp_free(heatmap_stamp_t *s) {
    free(s->buf);
    free(s);
}

heatmap_colorscheme_t *heatmap_colorscheme_load(const unsigned char *in_colors, size_t ncolors) {
    heatmap_colorscheme_t *cs = (heatmap_colorscheme_t *) calloc(1, sizeof(heatmap_colorscheme_t));
    unsigned char *colors = (unsigned char *) malloc(4 * ncolors);

    if (!cs || !colors) {
        free(cs);
        free(colors);
        return 0;
    }

    memcpy(colors, in_colors, 4 * ncolors);

    cs->colors = colors;
    cs->ncolors = ncolors;
    return cs;
}

void heatmap_colorscheme_free(heatmap_colorscheme_t *cs) {
    /* ehhh, const_cast<>! */
    free((void *) cs->colors);
    free(cs);
}

/* Sorry dynamic wordwarp editor users! But you deserve no better anyways... */
static const unsigned char mixed_data[] = {
        0, 0, 0, 0, 54, 52, 61, 255, 53, 52, 61, 255, 52, 51, 61, 255, 50, 50, 61, 255, 50, 50, 62, 255, 49, 49, 63,
        255, 48, 48,
        63, 255, 47, 47, 63, 255, 46, 46, 64, 255, 45, 45, 64, 255, 44, 44, 65, 255, 43, 43, 65, 255, 42, 42, 65, 255,
        41, 41, 66, 255, 40, 40, 66, 255, 39, 39, 68, 255, 37, 37, 66, 255, 36, 36, 68, 255, 35, 35, 68, 255, 33, 33,
        68, 255, 32, 32, 68, 255, 32, 32, 68, 255, 31, 31, 70, 255, 29, 29, 69, 255, 28, 28, 70, 255, 26, 26, 69, 255,
        25, 25, 70, 255, 24, 24, 71, 255, 22, 22, 71, 255, 21, 21, 72, 255, 20, 20, 73, 255, 18, 18, 73, 255, 17, 17,
        73, 255, 16, 16, 74, 255, 15, 15, 75, 255, 14, 14, 76, 255, 13, 13, 76, 255, 12, 12, 77, 255, 11, 11, 77, 255,
        10, 10, 77, 255, 9, 9, 77, 255, 8, 8, 78, 255, 7, 7, 78, 255, 7, 7, 78, 255, 7, 7, 80, 255, 6, 6, 82, 255, 5, 5,
        83, 255, 5, 5, 85, 255, 4, 5, 87, 255, 4, 5, 87, 255, 3, 4, 92, 255, 3, 5, 91, 255, 2, 4, 94, 255, 2, 4, 96,
        255, 2, 5, 98, 255, 1, 5, 100, 255, 1, 5, 103, 255, 1, 6, 106, 255, 1, 7, 108, 255, 1, 8, 109, 255, 1, 9, 115,
        255, 0, 9, 116, 255, 0, 10, 119, 255, 0, 12, 121, 255, 0, 12, 121, 255, 0, 13, 124, 255, 0, 15, 127, 255, 0, 17,
        129, 255, 0, 18, 130, 255, 0, 20, 135, 255, 0, 22, 138, 255, 0, 24, 140, 255, 0, 26, 143, 255, 0, 28, 145, 255,
        0, 31, 147, 255, 0, 33, 150, 255, 0, 36, 152, 255, 0, 39, 155, 255, 0, 41, 158, 255, 0, 44, 161, 255, 0, 47,
        162, 255, 0, 50, 165, 255, 0, 53, 168, 255, 0, 56, 170, 255, 0, 59, 172, 255, 0, 62, 175, 255, 0, 62, 175, 255,
        0, 67, 177, 255, 0, 69, 179, 255, 0, 74, 182, 255, 0, 77, 184, 255, 0, 80, 185, 255, 0, 84, 188, 255, 0, 88,
        191, 255, 0, 92, 191, 255, 0, 95, 194, 255, 0, 99, 196, 255, 0, 102, 197, 255, 0, 106, 199, 255, 0, 109, 201,
        255, 0, 112, 202, 255, 0, 114, 204, 255, 0, 116, 205, 255, 0, 119, 207, 255, 0, 121, 209, 255, 0, 125, 210, 255,
        0, 130, 213, 255, 0, 130, 213, 255, 0, 135, 216, 255, 0, 138, 217, 255, 0, 143, 220, 255, 0, 147, 223, 255, 0,
        151, 225, 255, 0, 157, 228, 255, 0, 160, 230, 255, 0, 165, 232, 255, 0, 169, 234, 255, 0, 173, 237, 255, 0, 177,
        239, 255, 0, 181, 241, 255, 0, 185, 242, 255, 0, 189, 244, 255, 0, 193, 246, 255, 0, 196, 247, 255, 0, 200, 249,
        255, 0, 203, 250, 255, 0, 206, 251, 255, 0, 210, 253, 255, 0, 213, 254, 255, 0, 215, 255, 255, 0, 218, 255, 255,
        0, 218, 255, 255, 0, 220, 255, 255, 0, 223, 255, 255, 0, 226, 255, 255, 0, 227, 255, 255, 0, 229, 255, 255, 0,
        231, 255, 255, 0, 233, 255, 255, 0, 234, 255, 255, 0, 234, 254, 255, 0, 234, 253, 255, 0, 234, 252, 255, 0, 234,
        251, 255, 0, 234, 250, 255, 0, 234, 248, 255, 0, 234, 247, 255, 0, 234, 245, 255, 0, 234, 244, 255, 0, 234, 244,
        255, 0, 234, 242, 255, 0, 234, 240, 255, 0, 234, 239, 255, 0, 234, 236, 255, 0, 234, 234, 255, 0, 234, 233, 255,
        0, 234, 230, 255, 0, 234, 227, 255, 0, 234, 225, 255, 0, 234, 222, 255, 0, 234, 219, 255, 0, 234, 217, 255, 0,
        234, 214, 255, 0, 234, 211, 255, 0, 233, 208, 255, 0, 232, 205, 255, 0, 231, 202, 255, 0, 230, 199, 255, 0, 228,
        195, 255, 0, 227, 193, 255, 0, 227, 189, 255, 0, 225, 186, 255, 0, 223, 183, 255, 0, 222, 179, 255, 0, 221, 176,
        255, 0, 220, 173, 255, 0, 218, 169, 255, 0, 217, 166, 255, 0, 216, 163, 255, 0, 215, 161, 255, 0, 214, 159, 255,
        0, 213, 156, 255, 0, 212, 155, 255, 0, 211, 153, 255, 0, 210, 150, 255, 0, 209, 147, 255, 0, 208, 145, 255, 0,
        208, 143, 255, 0, 206, 140, 255, 0, 205, 138, 255, 0, 204, 136, 255, 0, 203, 134, 255, 0, 203, 134, 255, 0, 202,
        131, 255, 0, 201, 129, 255, 0, 200, 127, 255, 0, 200, 124, 255, 0, 198, 122, 255, 0, 198, 120, 255, 0, 197, 118,
        255, 0, 196, 116, 255, 0, 195, 114, 255, 0, 195, 112, 255, 0, 194, 109, 255, 0, 193, 107, 255, 0, 191, 105, 255,
        0, 191, 103, 255, 0, 190, 101, 255, 0, 189, 99, 255, 0, 189, 96, 255, 0, 188, 95, 255, 0, 187, 93, 255, 0, 186,
        91, 255, 0, 186, 89, 255, 0, 185, 87, 255, 0, 185, 85, 255, 0, 184, 83, 255, 0, 184, 83, 255, 0, 183, 81, 255,
        0, 183, 80, 255, 0, 183, 78, 255, 0, 182, 76, 255, 0, 182, 75, 255, 0, 182, 73, 255, 0, 181, 71, 255, 0, 181,
        69, 255, 0, 181, 68, 255, 0, 181, 67, 255, 0, 180, 65, 255, 0, 180, 64, 255, 0, 180, 63, 255, 0, 180, 61, 255,
        0, 180, 60, 255, 0, 180, 59, 255, 0, 180, 58, 255, 0, 180, 58, 255, 2, 180, 56, 255, 3, 180, 55, 255, 4, 180,
        54, 255, 6, 181, 53, 255, 7, 181, 52, 255, 9, 182, 51, 255, 11, 181, 49, 255, 12, 182, 48, 255, 13, 183, 47,
        255, 16, 183, 46, 255, 17, 184, 46, 255, 19, 184, 45, 255, 22, 185, 43, 255, 23, 185, 43, 255, 25, 186, 42, 255,
        28, 187, 40, 255, 29, 187, 39, 255, 32, 189, 39, 255, 34, 190, 38, 255, 36, 190, 37, 255, 39, 191, 36, 255, 42,
        192, 35, 255, 42, 192, 35, 255, 43, 193, 34, 255, 46, 194, 34, 255, 48, 195, 33, 255, 51, 196, 32, 255, 54, 197,
        31, 255, 56, 198, 30, 255, 59, 199, 30, 255, 62, 201, 29, 255, 65, 202, 28, 255, 67, 202, 28, 255, 70, 204, 27,
        255, 72, 205, 26, 255, 75, 207, 25, 255, 78, 208, 25, 255, 82, 208, 25, 255, 84, 210, 24, 255, 87, 211, 23, 255,
        90, 212, 22, 255, 90, 212, 22, 255, 93, 214, 22, 255, 95, 215, 21, 255, 99, 216, 21, 255, 102, 218, 20, 255,
        104, 218, 20, 255, 108, 220, 19, 255, 111, 221, 19, 255, 114, 222, 19, 255, 117, 224, 18, 255, 119, 225, 18,
        255, 122, 227, 17, 255, 125, 228, 16, 255, 128, 229, 16, 255, 132, 230, 16, 255, 135, 231, 15, 255, 137, 232,
        15, 255, 141, 233, 14, 255, 144, 235, 14, 255, 147, 235, 14, 255, 150, 237, 13, 255, 153, 238, 13, 255, 156,
        240, 12, 255, 159, 241, 12, 255, 162, 241, 12, 255, 165, 243, 12, 255, 167, 243, 11, 255, 167, 243, 11, 255,
        170, 244, 11, 255, 174, 245, 11, 255, 176, 246, 10, 255, 179, 247, 10, 255, 182, 248, 10, 255, 184, 249, 9, 255,
        187, 250, 9, 255, 190, 250, 9, 255, 193, 251, 8, 255, 195, 251, 8, 255, 198, 252, 8, 255, 201, 252, 7, 255, 203,
        252, 7, 255, 206, 252, 6, 255, 209, 252, 7, 255, 209, 252, 7, 255, 211, 252, 7, 255, 213, 252, 5, 255, 216, 252,
        6, 255, 219, 252, 5, 255, 220, 252, 5, 255, 223, 252, 5, 255, 225, 252, 5, 255, 227, 252, 4, 255, 230, 252, 4,
        255, 232, 252, 3, 255, 233, 252, 4, 255, 235, 252, 3, 255, 237, 252, 3, 255, 240, 252, 2, 255, 241, 252, 2, 255,
        243, 252, 2, 255, 244, 252, 2, 255, 247, 252, 1, 255, 248, 252, 2, 255, 249, 252, 1, 255, 250, 252, 1, 255, 252,
        252, 0, 255, 253, 252, 1, 255, 255, 252, 1, 255, 255, 251, 0, 255, 255, 251, 0, 255, 255, 249, 0, 255, 255, 248,
        0, 255, 255, 246, 0, 255, 255, 245, 0, 255, 255, 244, 0, 255, 255, 242, 0, 255, 255, 241, 0, 255, 255, 239, 0,
        255, 255, 237, 0, 255, 255, 235, 0, 255, 255, 234, 0, 255, 255, 232, 0, 255, 255, 229, 0, 255, 255, 227, 0, 255,
        255, 225, 0, 255, 255, 222, 0, 255, 255, 222, 0, 255, 255, 221, 0, 255, 255, 218, 0, 255, 255, 216, 0, 255, 255,
        213, 0, 255, 255, 211, 0, 255, 255, 208, 0, 255, 255, 206, 0, 255, 255, 203, 0, 255, 255, 200, 0, 255, 255, 198,
        0, 255, 255, 194, 0, 255, 255, 191, 0, 255, 255, 189, 0, 255, 255, 185, 0, 255, 255, 183, 0, 255, 255, 180, 0,
        255, 255, 177, 0, 255, 255, 173, 0, 255, 255, 171, 0, 255, 255, 167, 0, 255, 255, 165, 0, 255, 255, 161, 0, 255,
        255, 158, 0, 255, 255, 155, 0, 255, 255, 152, 0, 255, 255, 149, 0, 255, 255, 145, 0, 255, 255, 145, 0, 255, 255,
        142, 0, 255, 255, 139, 0, 255, 255, 135, 0, 255, 255, 132, 0, 255, 255, 129, 0, 255, 255, 126, 0, 255, 255, 122,
        0, 255, 255, 119, 0, 255, 255, 116, 0, 255, 255, 112, 0, 255, 255, 109, 0, 255, 255, 106, 0, 255, 255, 103, 0,
        255, 255, 103, 0, 255, 255, 99, 0, 255, 255, 96, 0, 255, 255, 93, 0, 255, 255, 90, 0, 255, 255, 86, 0, 255, 255,
        83, 0, 255, 255, 80, 0, 255, 255, 77, 0, 255, 255, 74, 0, 255, 255, 71, 0, 255, 255, 67, 0, 255, 255, 65, 0,
        255, 255, 62, 0, 255, 255, 59, 0, 255, 255, 57, 0, 255, 255, 53, 0, 255, 255, 51, 0, 255, 255, 47, 0, 255, 255,
        45, 0, 255, 255, 42, 0, 255, 255, 40, 0, 255, 255, 37, 0, 255, 255, 35, 0, 255, 255, 35, 0, 255, 255, 32, 0,
        255, 255, 29, 0, 255, 255, 27, 0, 255, 255, 25, 0, 255, 255, 23, 0, 255, 255, 21, 0, 255, 255, 19, 0, 255, 255,
        16, 0, 255, 255, 14, 0, 255, 255, 12, 0, 255, 255, 11, 0, 255, 255, 9, 0, 255, 255, 7, 0, 255, 255, 6, 0, 255,
        255, 4, 0, 255, 255, 3, 0, 255, 255, 1, 0, 255, 255, 0, 0, 255, 255, 0, 0, 255, 255, 0, 0, 255, 255, 0, 0, 255,
        255, 0, 0, 255, 255, 0, 0, 255, 255, 0, 0, 255, 255, 0, 0, 255, 255, 0, 0, 255, 255, 0, 0, 255, 255, 0, 0, 255,
        255, 0, 0, 255, 255, 0, 0, 255, 255, 0, 0, 255, 255, 0, 0, 255, 255, 0, 0, 255, 255, 0, 0, 255, 255, 1, 1, 255,
        255, 1, 1, 255, 255, 1, 1, 255, 255, 1, 1, 255, 255, 1, 1, 255, 255, 2, 2, 255, 255, 2, 2, 255, 255, 2, 2, 255,
        255, 3, 3, 255, 255, 3, 3, 255, 255, 4, 4, 255, 255, 5, 5, 255, 255, 6, 6, 255, 255, 6, 6, 255, 255, 6, 6, 255,
        255, 8, 8, 255, 255, 9, 9, 255, 255, 10, 10, 255, 255, 12, 12, 255, 255, 13, 13, 255, 255, 15, 15, 255, 255, 17,
        17, 255, 255, 20, 20, 255, 255, 22, 22, 255, 255, 25, 25, 255, 255, 28, 28, 255, 255, 32, 32, 255, 255, 32, 32,
        255, 255, 36, 36, 255, 255, 41, 41, 255, 255, 45, 45, 255, 255, 50, 50, 255, 255, 55, 55, 255, 255, 61, 61, 255,
        255, 67, 67, 255};
static const heatmap_colorscheme_t cs_spectral_mixed = {mixed_data, sizeof(mixed_data) / sizeof(mixed_data[0]) / 4};
const heatmap_colorscheme_t *heatmap_cs_default = &cs_spectral_mixed;

